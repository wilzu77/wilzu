<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wilzu Bot - Dashboard</title>
<style>
body { font-family: Arial; background:#f4f4f4; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0; }
.container { background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); width:80%; max-width:600px; }
h1,h2 { text-align:center; color:#333; }
.form-group { margin-bottom:15px; }
label { display:block; font-weight:bold; margin-bottom:5px; }
input[type="number"], select, input[type="text"] { width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; margin-bottom:10px; }
button { background:#4caf50; color:white; padding:10px 15px; border:none; border-radius:4px; cursor:pointer; font-size:16px; }
button:hover { background:#45a049; }
.account-list { margin-top:20px; border:1px solid #ddd; border-radius:4px; padding:10px; }
.account-item { margin-bottom:10px; padding:10px; border:1px solid #eee; border-radius:4px; }
.account-details { margin-top:5px; }
</style>
</head>
<body>
<div class="container">
<h1>Wilzu Bot - Dashboard</h1>

<h2>Topup Saldo</h2>
<form id="topup-form">
<div class="form-group"><label>User ID Telegram:</label><input type="number" id="userId" required></div>
<div class="form-group"><label>Jumlah Topup (Rp):</label><input type="number" id="amount" required></div>
<button type="submit">Kirim Topup</button>
</form>

<h2>Beli Akun</h2>
<div class="form-group"><label>User ID Telegram:</label><input type="number" id="buy-userId" required></div>
<div class="form-group"><label>Kategori Akun:</label>
<select id="account-type">
<option value="netflix">Netflix</option>
<option value="spotify">Spotify</option>
<option value="capcut">Capcut</option>
<option value="youtube">Youtube</option>
<option value="gpt">GPT</option>
<option value="freefire">FreeFire</option>
<option value="mobilelegend">Mobile Legend</option>
<option value="alingmotion">Alight Motion</option>
</select>
</div>
<button onclick="buyAccount()">Beli Akun</button>

<h2>Stok Akun</h2>
<div class="account-list" id="account-list"></div>
</div>

<script>
async function submitTopupRequest(e){
  e.preventDefault();
  const userId = document.getElementById('userId').value;
  const amount = document.getElementById('amount').value;
  const res = await fetch('/topup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,amount})});
  const data = await res.json();
  alert(data.message);
}

async function buyAccount(){
  const userId = document.getElementById('buy-userId').value;
  const accountType = document.getElementById('account-type').value;
  const res = await fetch('/buy',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,accountType})});
  const data = await res.json();
  alert(data.message);
}

async function loadAccountStock(){
  const list = document.getElementById('account-list');
  list.innerHTML = 'Loading...';
  try{
    const res = await fetch('/stock');
    const data = await res.json();
    let html='';
    for(const cat in data){
      html+=`<h3>${cat.charAt(0).toUpperCase()+cat.slice(1)}</h3>`;
      data[cat].forEach(a=>{
        html+=`<div class="account-item"><p>Email: ${a.email}</p><div class="account-details"><p>Password: ${a.password}</p></div></div>`;
      });
    }
    list.innerHTML = html || 'Tidak ada stok.';
  }catch(e){ list.innerHTML='Gagal load stok'; console.error(e); }
}

document.getElementById('topup-form').addEventListener('submit',submitTopupRequest);
loadAccountStock();
</script>
</body>
</html>
